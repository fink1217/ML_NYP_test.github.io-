<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>NumPy 懶人包｜單檔版</title>

    <!-- Tailwind CDN（含 safelist，確保動態 class 會被產生） -->
    <script>
      window.tailwind = {
        config: {
          safelist: [
            // 高亮/邊框/按鈕動態樣式
            'ring-2','ring-emerald-500',
            'bg-emerald-700','bg-amber-700','bg-zinc-700','hover:bg-zinc-600',
            'border-emerald-600','border-emerald-700/50',
            'bg-emerald-500/10','bg-emerald-500/20','bg-emerald-500/30'
          ]
        }
      }
    </script>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React 18 UMD + Babel（瀏覽器即時編譯 JSX，免打包） -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="min-h-screen bg-zinc-950 text-zinc-100">
    <div id="root"></div>

    <script type="text/babel">
      const { useMemo, useState, useEffect, useRef } = React;

      // ====== 小工具與可視化 ======
      function Heatmap({ matrix, title }) {
        const rows = matrix.length;
        const cols = matrix[0].length;
        let min = Infinity, max = -Infinity;
        for (let r = 0; r < rows; r++) for (let c = 0; c < cols; c++) { const v = matrix[r][c]; if (v < min) min = v; if (v > max) max = v; }
        const norm = (v) => (max === min ? 0.5 : (v - min) / (max - min));
        return (
          <div>
            {title && <div className="mb-2 text-sm text-zinc-400">{title}</div>}
            <div className="grid gap-[2px]" style={{ gridTemplateColumns: `repeat(${cols}, 14px)`, gridTemplateRows: `repeat(${rows}, 14px)` }}>
              {matrix.flatMap((row, r) => row.map((v, c) => (
                <div key={`${r}-${c}`} title={`(${r},${c})=${v}`} className="rounded-[2px]" style={{ background: `hsl(${220 - 220 * norm(v)} 70% ${20 + 60 * norm(v)}%)` }} />
              )))}
            </div>
          </div>
        );
      }
      function PointPlot({ pts, pts2, title }) {
        const size = 240; const toX = (x) => ((x + 1.2) / 2.4) * size; const toY = (y) => (1 - (y + 1.2) / 2.4) * size;
        return (
          <div>
            {title && <div className="mb-2 text-sm text-zinc-400">{title}</div>}
            <svg width={size} height={size} className="rounded-xl border border-zinc-800 bg-zinc-900">
              <line x1={toX(-1.2)} y1={toY(0)} x2={toX(1.2)} y2={toY(0)} stroke="#555" />
              <line x1={toX(0)} y1={toY(-1.2)} x2={toX(0)} y2={toY(1.2)} stroke="#555" />
              {pts.map((p, i) => (<circle key={`a-${i}`} cx={toX(p[0])} cy={toY(p[1])} r={2} fill="#6ee7b7" />))}
              {pts2?.map((p, i) => (<circle key={`b-${i}`} cx={toX(p[0])} cy={toY(p[1])} r={2} fill="#93c5fd" />))}
            </svg>
          </div>
        );
      }
      function makeMatrix(rows, cols) { return Array.from({ length: rows }, (_, r) => Array.from({ length: cols }, (_, c) => r * 10 + c)); }
      function transpose(m) { const t = Array.from({ length: m[0].length }, () => Array(m.length).fill(0)); for (let r=0;r<m.length;r++) for (let c=0;c<m[0].length;c++) t[c][r]=m[r][c]; return t; }
      function makePoints(n=100){const out=[];for(let i=0;i<n;i++){const x=Math.random()*2-1;const y=Math.random()*2-1;out.push([x,y]);}return out;}
      function rotatePoints(pts,deg=30){const th=deg*Math.PI/180,ct=Math.cos(th),st=Math.sin(th);return pts.map(([x,y])=>[ct*x-st*y,st*x+ct*y]);}

      // ====== 文字處理（函式定位用） ======
      const slugifyItemName = (name) => {
        return name.replace(/\s+/g, '').replace(/\(.*\)/, '').replace(/[^a-zA-Z0-9._]/g, '-');
      };
      const tokensFromName = (name) => {
        const tokens = new Set();
        const m = name.match(/[a-zA-Z_]\w*(?:\.[a-zA-Z_]\w*)*/g);
        if (m) m.forEach((t) => tokens.add(t));
        if (name.includes('@')) tokens.add('@');
        return Array.from(tokens);
      };

      // ====== 資料：用途（Use Cases） ======
      const USE_CASES = [
        { id: "image-processing", title: "影像處理入門", brief: "使用 NumPy 操作影像陣列（灰階/彩色），示範旋轉、模糊、閾值化與形態學前置運算。", bullets: ["影像是 H×W×C 的 3D 陣列（uint8 常見）","旋轉/平移可用仿射矩陣或索引重排","快速門檻處理（thresholding）"], functions: ["np.array","np.reshape","np.pad","np.stack","np.clip"] },
        { id: "linear-algebra", title: "線性代數與幾何", brief: "示範矩陣乘法、解聯立方程、特徵值/向量，含 2D/3D 幾何轉換（旋轉 + 位移）。", bullets: ["@ 或 np.dot 進行矩陣乘法","np.linalg.solve 求解 Ax=b","np.linalg.eig 瞭解主軸/模式"], functions: ["@","np.dot","np.eye","np.linalg.solve","np.linalg.eig"] },
        { id: "data-io", title: "資料處理與 I/O", brief: "以 .npy/.npz 快速讀寫陣列，搭配 CSV/TSV 前處理，比較速度與精度。", bullets: ["np.save / np.load 保精度又快","np.genfromtxt / np.loadtxt 讀表","壓縮儲存：np.savez_compressed"], functions: ["np.save","np.load","np.savez_compressed","np.genfromtxt"] },
        { id: "simulation", title: "隨機模擬與實驗", brief: "用亂數產生器（Generator）進行蒙地卡羅實驗與統計估計。", bullets: ["np.random.default_rng 建立 RNG","向量化抽樣提升速度","重現性：固定 seed"], functions: ["np.random.default_rng","rng.normal","rng.choice","np.mean"] },
        { id: "reshape-broadcast", title: "重塑與廣播", brief: "用 reshape/transpose 與 broadcasting 寫出更精簡的向量化運算。", bullets: ["np.reshape / np.transpose","np.newaxis / None 擴維","廣播規則減少 for 迴圈"], functions: ["np.reshape","np.transpose","np.newaxis","np.broadcast_to"] },
      ];

      // ====== 資料：演示（Demos & Mini Projects） ======
      const DEMOS = [
        { id: "demo-image-rotate", title: "影像旋轉（純 NumPy 版）", goal: "將 5×5 灰階影像旋轉 90°，示範索引與轉置。", code: `import numpy as np\nimg = np.arange(25).reshape(5,5)\nrot90 = img.T[::-1]\nprint(rot90)`, output: `[[ 4  9 14 19 24]\n [ 3  8 13 18 23]\n [ 2  7 12 17 22]\n [ 1  6 11 16 21]\n [ 0  5 10 15 20]]`, notes: ["img.T 為轉置；[::-1] 反轉列順序即達 90° 旋轉（順時針）","影像型別若為 uint8，請留意溢位；本例為小整數安全"] },
        { id: "demo-least-squares", title: "最小平方法：一次線性回歸 y = ax + b", goal: "用 np.linalg.lstsq 擬合（無需 sklearn），回傳係數與殘差。", code: `import numpy as np\nx = np.array([0,1,2,3,4])\ny = np.array([1.1,2.0,2.9,4.2,4.9])\nA = np.vstack([x, np.ones_like(x)]).T\n# 求解 [a, b]\n[a, b], *_ = np.linalg.lstsq(A, y, rcond=None)\nprint(round(a,3), round(b,3))`, output: `0.96 1.06`, notes: ["A 形狀為 (N,2)：第一欄 x、第二欄常數 1","lstsq 回傳多項資訊，前兩個即係數 a,b"] },
        { id: "demo-fk-2link", title: "機械手臂 2 連桿前向運動學（平面）", goal: "給兩關節角度 θ1, θ2 與桿長 L1, L2，求末端 (x,y)。", code: `import numpy as np\nL1, L2 = 1.0, 0.7\nth1, th2 = np.deg2rad([30, 45])\nx = L1*np.cos(th1) + L2*np.cos(th1+th2)\ny = L1*np.sin(th1) + L2*np.sin(th1+th2)\nprint(round(x,3), round(y,3))`, output: `1.047 1.176`, notes: ["平面 2R 模型；角度請轉弧度","可延伸成齊次座標與 3D 旋轉矩陣版本"] },
        { id: "demo-csv-stats", title: "CSV 讀取與欄位統計", goal: "以 genfromtxt 讀取簡單 CSV，計算每欄平均。", code: `import numpy as np\nfrom io import StringIO\ncsv = StringIO("x,y,z\\n1,2,3\\n4,5,6\\n7,8,9")\narr = np.genfromtxt(csv, delimiter=",", names=True)\nprint(arr.dtype.names)\nprint(np.mean(arr['x']), np.mean(arr['y']), np.mean(arr['z']))`, output: `('x', 'y', 'z')\n4.0 5.0 6.0`, notes: ["names=True 會用首行當欄位名，回傳結構化陣列","若需更高效率，建議直接使用 np.loadtxt 於純數值表"] },
      ];

      // ====== 資料：函式細節（Functions Catalog） ======
      const FUNCTIONS = [
        { id: "cat-01-create", title: "① 建立陣列（Array Creation）", items: [
          { name: "np.zeros(shape, dtype=...)", desc: "建立全 0 陣列（黑色影像、空白矩陣、初始化）", what: "建立一個全部填滿 0 的陣列。", uses: ["建立影像遮罩（全部透明或黑色）","神經網路的權重/狀態初始化"], notes: ["影像通常用 uint8（0~255），數值運算常用 float32","shape 用 (行數, 列數) 表示"], code: `import numpy as np\nm = np.zeros((3,4), dtype=np.uint8)\nprint(m)`, output: `[[0 0 0 0]\n [0 0 0 0]\n [0 0 0 0]]`, imgdesc: "一張 3×4 的黑色方格（每格值為 0）。" },
          { name: "np.ones(shape, dtype=...)", desc: "建立全 1 陣列（全白影像、常數矩陣）", what: "建立一個全部填滿 1 的陣列。", uses: ["偏置向量（bias）的初始化","移動平均初值"], notes: ["若要其他數字，可用 np.ones(...)*k 或 np.full(... )"], code: `import numpy as np\nb = np.ones((2,3))\nprint(b)`, output: `[[1. 1. 1.]\n [1. 1. 1.]]`, imgdesc: "一張 2×3 的白色方格（每格值為 1）。" },
          { name: "np.full(shape, value, dtype=...)", desc: "建立固定值陣列", what: "建立一個全部填滿你指定數值的陣列。", uses: ["建立灰階影像底圖（全部 128）","建立基準面（例如全部填 π）"], notes: ["比 np.ones()*k 更安全，不容易有型別錯誤"], code: `import numpy as np\npi_mat = np.full((2,3), np.pi)\nprint(pi_mat)`, output: `[[3.141593 3.141593 3.141593]\n [3.141593 3.141593 3.141593]]`, imgdesc: "一張 2×3 的方格，每格都是 3.141593（π）。" },
          { name: "np.empty(shape, dtype=...)", desc: "建立未初始化內容的陣列（僅佔位）", what: "建立形狀固定，但裡面數值未定（記憶體殘值）。", uses: ["大型暫存陣列（之後會馬上覆寫）"], notes: ["內容是記憶體中的舊資料，建立後一定要覆寫，否則會出現亂數"], code: `import numpy as np\nbuf = np.empty((2,4))\nbuf[:] = 0.0\nprint(buf)`, output: `[[0. 0. 0. 0.]\n [0. 0. 0. 0.]]`, imgdesc: "一張 2×4 的黑色方格（初始化後的結果）。" },
          { name: "np.array(list)", desc: "將 Python list 轉成 NumPy 陣列", what: "把一般 list 轉換成可向量化運算的陣列。", uses: ["把 CSV / JSON 讀入的資料轉成陣列以加快運算"], notes: ["若子 list 長度不同，會變成 object 型別，失去數值運算加速優勢"], code: `import numpy as np\narr = np.array([[1,2,3],[10,20,30]])\nprint(arr)`, output: `[[ 1  2  3]\n [10 20 30]]`, imgdesc: "兩列三行的數字表格。" },
          { name: "np.arange(start, stop, step, dtype=...)", desc: "建立等差數列（不含 stop）", what: "建立一個不包含終點的等差數列。", uses: ["生成時間序列","影像幀索引"], notes: ["浮點步長可能有誤差；要固定點數請用 np.linspace"], code: `import numpy as np\nt = np.arange(0, 2.5, 0.5)\nprint(t)`, output: `[0.  0.5 1.  1.5 2. ]`, imgdesc: "數軸上等距的點（間隔 0.5）。" },
          { name: "np.linspace(start, stop, num)", desc: "建立等距數列（含終點，控制總點數）", what: "建立一個包含終點、可控制點數的等距數列。", uses: ["機械手臂關節插值","繪圖座標生成"], notes: ["想控制步長用 arange；想控制點數用 linspace"], code: `import numpy as np\njoints = np.linspace(-90, 90, 7)\nprint(joints)`, output: `[-90. -60. -30.   0.  30.  60.  90.]`, imgdesc: "從 -90 到 90 平均分成 7 個角度值。" },
          { name: "np.random.rand(d0, d1, ...)", desc: "產生 0~1 均勻分布亂數", what: "建立介於 0 與 1 的均勻分布亂數陣列。", uses: ["蒙地卡羅模擬","動態效果測試"], notes: ["想重現結果要先 np.random.seed(固定值)","現代 API 建議使用 Generator（np.random.default_rng）"], code: `import numpy as np\nnp.random.seed(0)\nu = np.random.rand(2,3)\nprint(u)`, output: `[[0.548814 0.715189 0.602763]\n [0.544883 0.423655 0.645894]]`, imgdesc: "2×3 的均勻亂數表格。" },
          { name: "np.random.randn(d0, d1, ...)", desc: "產生常態分布亂數（μ=0, σ=1）", what: "產生標準常態分布亂數，可再線性轉換成任意 μ, σ。", uses: ["模擬感測器噪聲","資料增強"], notes: ["要改平均與標準差可用 x*σ + μ","建議固定 seed 以重現實驗"], code: `import numpy as np\nnp.random.seed(0)\nn = np.random.randn(2,3)*2 + 5\nprint(np.round(n,6))`, output: `[[8.528105 5.800314 6.957476]\n [9.481786 8.735116 3.045444]]`, imgdesc: "2×3 的常態亂數表格（平均值約 5）。" },
          { name: "np.random.default_rng(seed)", desc: "建立現代亂數產生器（Generator）", what: "回傳 Generator 物件（預設 PCG64），可重現測試並改善並行抽樣。", uses: ["在函式/類別內持有 rng，避免全域狀態","為每次實驗設定 seed 以重現結果"], notes: ["Generator API 取代舊的 np.random.* 全域函式"], code: `import numpy as np\nrng = np.random.default_rng(123)\nx = rng.random(3)\nprint(x.shape)`, output: `(3,)` },
          { name: "rng.normal(loc, scale, size)", desc: "以 Generator 取樣常態分布", what: "透過 rng.normal 抽樣，避免全域狀態污染。", uses: ["加入高斯雜訊","建立測試資料"], notes: ["先以 np.random.default_rng(seed) 建立 rng"], code: `import numpy as np\nrng = np.random.default_rng(0)\nsamples = rng.normal(5, 2, (2,3))\nprint(samples.shape)`, output: `(2, 3)` },
          { name: "rng.choice(a, size, replace=True, p=None)", desc: "以 Generator 進行隨機選取", what: "可指定是否重複與機率分佈。", uses: ["抽樣子集","洗牌/抽獎模擬"], notes: ["replace=False 表示不重複抽樣"], code: `import numpy as np\nrng = np.random.default_rng(0)\na = np.array([10,20,30,40])\npick = rng.choice(a, size=3, replace=False)\nprint(pick.shape, np.all(np.isin(pick, a)))`, output: `(3,) True` },
        ]},
        { id: "cat-02-attrs", title: "② 陣列資訊（Array Attributes）", items: [
          { name: "a.shape", desc: "回傳陣列的形狀（行數、列數、…）", what: "取得每個維度的長度，例如 2D 的 (rows, cols)、3D 的 (depth, height, width)。", uses: ["確認資料維度是否正確","在 reshape / 切片前先檢查大小"], code: `import numpy as np\na = np.arange(12).reshape(3,4)\nprint(a.shape)`, output: `(3, 4)`, notes: ["解釋：表示陣列有 3 行 4 列。"] },
          { name: "a.ndim", desc: "回傳陣列的維度數（rank）", what: "用來判斷是一維、二維或更高維陣列。", uses: ["影像處理中判斷是否含顏色通道（灰階 H×W → ndim=2；彩色 H×W×C → ndim=3）"], code: `import numpy as np\na = np.arange(12).reshape(3,4)\nprint(a.ndim)`, output: `2`, notes: ["解釋：這是一個二維陣列。"] },
          { name: "a.size", desc: "回傳陣列的總元素數量", what: "等於所有維度長度的乘積。", uses: ["快速估算資料量","檢查 reshape 後元素總數是否一致"], code: `import numpy as np\na = np.arange(12).reshape(3,4)\nprint(a.size)`, output: `12`, notes: ["解釋：3 行 × 4 列，共 12 個元素。"] },
          { name: "a.dtype", desc: "回傳陣列元素的資料型態（int32、float64、uint8…）", what: "不同 dtype 影響數值範圍、精度與效能。", uses: ["確保數值範圍正確（影像常用 uint8）","加速運算（選擇 float32/float16 等）"], notes: ["平台不同，np.arange 預設 dtype 可能是 int64 或 int32。","若需指定精度，可在建立時使用 dtype=...（如 dtype=np.float32）。"], code: `import numpy as np\na = np.arange(12).reshape(3,4)\nprint(a.dtype)`, output: `int64` },
          { name: "a.itemsize", desc: "每個元素占用的位元組數（bytes）", what: "用於粗估記憶體用量：a.size * a.itemsize。", uses: ["大型陣列的記憶體規畫","低階效能調整"], code: `import numpy as np\na = np.arange(12).reshape(3,4)\nprint(a.itemsize)`, output: `8`, notes: ["解釋：int64 的元素大小為 8 bytes（64 位元）。實際大小依 dtype 而異。"] },
          { name: "a.data", desc: "底層緩衝區的記憶體位址（平常不需使用）", what: "提供與 C/C++/GPU 介面的低階存取資訊。", uses: ["低階除錯","與原生延伸模組交換資料"], notes: ["輸出格式與位址會因系統而異，僅作參考。"], code: `import numpy as np\na = np.arange(12).reshape(3,4)\nprint(a.data)`, output: `<memory at 0x000001D5A6F4B040>`, imgdesc: "這是 NumPy 陣列在記憶體中的位置表示。" },
        ]},
        { id: "cat-03-shape", title: "③ 形狀與軸（reshape / ravel / flatten / transpose / .T / swapaxes / meshgrid）", items: [
          { name: "np.reshape(a, shape)", desc: "改變形狀（元素數量必須相同）", code: `import numpy as np\na = np.arange(6)\nprint(a.reshape(2,3))`, output: `[[0 1 2]\n [3 4 5]]` },
          { name: "a.ravel() / a.flatten()", desc: "降成 1D（ravel 多半回傳 view；flatten 一定回傳 copy）", code: `import numpy as np\na = np.arange(6).reshape(2,3)\nprint(a.ravel())\nprint(a.flatten())`, output: `[0 1 2 3 4 5]\n[0 1 2 3 4 5]` },
          { name: "np.transpose(a, axes) / a.T", desc: "轉置或重排軸順序", code: `import numpy as np\na = np.arange(6).reshape(2,3)\nprint(a.T)`, output: `[[0 3]\n [1 4]\n [2 5]]`, demo: (() => { const A = makeMatrix(6, 8); const AT = transpose(A); return (<div className="grid md:grid-cols-2 gap-4"><Heatmap matrix={A} title={`A（${A.length}×${A[0].length}）`} /><Heatmap matrix={AT} title={`A.T（${AT.length}×${AT[0].length}）`} /></div>); })() },
          { name: "np.swapaxes(a, axis1, axis2)", desc: "交換兩個軸（多維資料常用）", code: `import numpy as np\na = np.arange(2*3*4).reshape(2,3,4)\nprint(np.swapaxes(a, 0, 1).shape)`, output: `(3, 2, 4)` },
          { name: "np.meshgrid(x, y, indexing=...)", desc: "建立座標網格（影像與場函數常用）", code: `import numpy as np\nx = np.linspace(-1,1,4)\ny = np.linspace(-1,1,3)\nX, Y = np.meshgrid(x, y)\nprint(X)\nprint(Y)`, output: `[[-1.  -0.33  0.33  1.  ]\n [-1.  -0.33  0.33  1.  ]\n [-1.  -0.33  0.33  1.  ]]\n[[-1. -1. -1. -1.]\n [ 0.  0.  0.  0.]\n [ 1.  1.  1.  1.]]` },
          { name: "np.pad(a, pad_width, mode='constant', constant_values=0)", desc: "在邊緣補值（影像邊框、訊號補零）", code: `import numpy as np\na = np.array([[1,2],[3,4]])\nprint(np.pad(a, 1, mode='constant', constant_values=0))`, output: `[[0 0 0 0]\n [0 1 2 0]\n [0 3 4 0]\n [0 0 0 0]]` },
        ]},
        { id: "cat-04-merge", title: "④ 合併與拆分（hstack / vstack / stack / split）", items: [
          { name: "np.hstack([a,b]) / np.vstack([a,b])", desc: "水平/垂直方向拼接", code: `import numpy as np\na = np.array([[1,2],[3,4]])\nb = np.array([[5,6],[7,8]])\nprint(np.hstack([a,b]))\nprint(np.vstack([a,b]))`, output: `[[1 2 5 6]\n [3 4 7 8]]\n[[1 2]\n [3 4]\n [5 6]\n [7 8]]` },
          { name: "np.stack([a,b], axis=...)", desc: "新增新軸後堆疊（維度+1）", code: `import numpy as np\na = np.array([1,2,3])\nb = np.array([4,5,6])\nprint(np.stack([a,b], axis=0))`, output: `[[1 2 3]\n [4 5 6]]` },
          { name: "np.split(a, indices_or_sections, axis)", desc: "依位置切分陣列", code: `import numpy as np\na = np.arange(10)\nleft, right = np.split(a, [6])\nprint(left, right)`, output: `[0 1 2 3 4 5] [6 7 8 9]` },
        ]},
        { id: "cat-05-indexing", title: "⑤ 索引與切片（slice / fancy / boolean / np.ix_）", items: [
          { name: "切片（slice）", desc: "a[r0:r1, c0:c1, ...]；左閉右開", code: `import numpy as np\na = np.arange(16).reshape(4,4)\nprint(a[1:3, 2:4])`, output: `[[ 6  7]\n [10 11]]` },
          { name: "花式索引（Fancy Indexing）", desc: "用索引陣列抽取子集", code: `import numpy as np\na = np.array([10,20,30,40])\nidx = [3,0,3,1]\nprint(a[idx])`, output: `[40 10 40 20]` },
          { name: "布林索引（Boolean Mask）", desc: "用條件建立遮罩來篩選元素", code: `import numpy as np\na = np.array([1,4,6,2,7])\nprint(a[a>3])`, output: `[4 6 7]` },
          { name: "np.ix_ 跨維選取", desc: "建立可廣播的索引器（常用於子矩陣抽取）", code: `import numpy as np\na = np.arange(25).reshape(5,5)\nrows = [1,3]\ncols = [0,2,4]\nprint(a[np.ix_(rows, cols)])`, output: `[[ 5  7  9]\n [15 17 19]]` },
        ]},
        { id: "cat-06-math", title: "⑥ 數學與統計（聚合 + ufunc）", items: [
          { name: "聚合：sum/mean/min/max(axis=...)", desc: "沿指定軸做彙總", code: `import numpy as np\na = np.arange(6).reshape(2,3)\nprint(a)\nprint(a.sum(axis=0))\nprint(a.mean(axis=1))`, output: `[[0 1 2]\n [3 4 5]]\n[3 5 7]\n[1. 4.]` },
          { name: "np.mean(a, axis=...) / a.mean(axis=...)", desc: "平均值（全域/沿軸）", code: `import numpy as np\na = np.array([[1,2,3],[4,5,6]])\nprint(np.mean(a))\nprint(a.mean(axis=0))\nprint(a.mean(axis=1))`, output: `3.5\n[2.5 3.5 4.5]\n[2. 5.]` },
          { name: "ufunc：np.sqrt / np.exp / np.clip", desc: "逐元素函數，支援廣播與 dtype 控制", code: `import numpy as np\na = np.array([-2., 0., 3., 9.])\nprint(np.sqrt(np.clip(a,0,None)))\nprint(np.exp([0,1]))`, output: `[0. 0. 1.73205081 3.]\n[1.         2.71828183]`, demo: (() => { const N=24,k=2; const grid = Array.from({length:N},(_,r)=>Array.from({length:N},(_,c)=>{ const x=(c/(N-1))*Math.PI*2; const y=(r/(N-1))*Math.PI*2; return Math.sin(k*x)*Math.cos(k*y);})); return <Heatmap matrix={grid} title="2D 場示意（sin(kx)·cos(ky)）"/>; })() },
        ]},
        { id: "cat-07-ops-bcast", title: "⑦ 運算與廣播（Elementwise + Broadcasting）", items: [
          { name: "+, -, *, /, **", desc: "逐元素四則與次方", code: `import numpy as np\na = np.array([1,2,3])\nb = np.array([4,5,6])\nprint(a + b, a * b, a ** 2)` , output: `[5 7 9] [ 4 10 18] [1 4 9]` },
          { name: "np.newaxis / None（擴維）", desc: "將 1D 升成 2D（或更高）以配合廣播", code: `import numpy as np\na = np.array([1,2,3])\nprint(a.shape, a[None,:].shape, a[:,None].shape)`, output: `(3,) (1, 3) (3, 1)` },
          { name: "np.broadcast_to(a, shape)", desc: "將較小陣列以只讀方式廣播到目標形狀", code: `import numpy as np\na = np.array([1,2,3])\nprint(np.broadcast_to(a, (2,3)))`, output: `[[1 2 3]\n [1 2 3]]` },
          { name: "廣播（Broadcasting）", desc: "None/np.newaxis 擴維，讓形狀自動對齊", code: `import numpy as np\nrow = np.array([1,2,3])[None, :]   # 1×3\ncol = np.array([10,20,30])[:, None] # 3×1\nprint(row + col)`, output: `[[11 12 13]\n [21 22 23]\n [31 32 33]]` },
          { name: "np.clip(a, min, max)", desc: "限制數值範圍", code: `import numpy as np\na = np.array([-2, 0, 3, 9])\nprint(np.clip(a, 0, 5))`, output: `[0 0 3 5]` },
        ]},
        { id: "cat-08-linalg", title: "⑧ 線性代數（矩陣乘、旋轉）", items: [
          { name: "A @ B / np.dot(A,B)", desc: "矩陣乘法", code: `import numpy as np\nA = np.array([[1,2],[3,4]])\nB = np.array([[5,6],[7,8]])\nprint(A @ B)`, output: `[[19 22]\n [43 50]]` },
          { name: "np.eye(N, M=None)", desc: "單位矩陣/對角矩陣生成", code: `import numpy as np\nprint(np.eye(3, dtype=int))`, output: `[[1 0 0]\n [0 1 0]\n [0 0 1]]` },
          { name: "2D 旋轉矩陣", desc: "R(θ) = [[cosθ,-sinθ],[sinθ,cosθ]]", code: `import numpy as np\nth = np.deg2rad(30)\nR = np.array([[np.cos(th),-np.sin(th)],[np.sin(th),np.cos(th)]])\nprint(np.round(R,3))`, output: `[[ 0.866 -0.5  ]\n [ 0.5    0.866]]`, demo: (() => { const pts = makePoints(120); const pts2 = rotatePoints(pts, 30); return <PointPlot pts={pts} pts2={pts2} title="點雲：原始（綠） vs 旋轉 30°（藍）"/>; })() },
          { name: "np.linalg.solve(A, b)", desc: "解 Ax=b（方陣）", code: `import numpy as np\nA = np.array([[3,1],[1,2]])\nb = np.array([9,8])\nx = np.linalg.solve(A, b)\nprint(np.round(x,3))`, output: `[2.   3. ]` },
          { name: "np.linalg.eig(A)", desc: "特徵值與特徵向量", code: `import numpy as np\nA = np.array([[2,0],[0,1]])\nw, V = np.linalg.eig(A)\nprint(np.round(w,3))\nprint(np.round(V,3))`, output: `[2. 1.]\n[[1. 0.]\n [0. 1.]]` },
        ]},
        { id: "cat-09-io", title: "⑨ 檔案存取（I/O）", items: [
          { name: "np.save / np.load (.npy)", desc: "單陣列快取（保精度）", code: `import numpy as np\na = np.random.rand(2,3)\nnp.save('x.npy', a)\na2 = np.load('x.npy')\nprint(a2.shape, np.allclose(a, a2))`, output: `(2, 3) True` },
          { name: "np.savez_compressed(.npz)", desc: "多陣列壓縮封裝", code: `import numpy as np\na = np.arange(4)\nb = np.eye(2)\nnp.savez_compressed('pack.npz', a=a, b=b)\nz = np.load('pack.npz')\nprint(list(z.keys()))`, output: `["a", "b"]` },
          { name: "np.genfromtxt / np.loadtxt", desc: "讀文字表（含缺值/純數值）", code: `import numpy as np\nfrom io import StringIO\nraw = StringIO('1,2\\n3,4')\na = np.loadtxt(raw, delimiter=',')\nprint(a, a.dtype)`, output: `[[1. 2.]\n [3. 4.]] float64` },
        ]},
      ];

      // ====== UI 元件 ======
      function Dropdown({ label, items }) {
        const [open, setOpen] = useState(false);
        const ref = useRef(null);
        useEffect(() => { const onDoc = (e) => { if (ref.current && !ref.current.contains(e.target)) setOpen(false); }; document.addEventListener("click", onDoc); return () => document.removeEventListener("click", onDoc); }, []);
        return (
          <div className="relative" ref={ref}>
            <button className="px-3 py-2 rounded-xl hover:bg-zinc-800/60 transition border border-zinc-700" onClick={() => setOpen((v) => !v)}>{label}</button>
            {open && (<div className="absolute mt-2 min-w-56 rounded-xl border border-zinc-700 bg-zinc-900/95 backdrop-blur p-2 shadow-2xl z-50">{items}</div>)}
          </div>
        );
      }
      function Accordion({ items }) {
        const [openIdx, setOpenIdx] = useState(null);
        return (
          <div className="space-y-3">
            {items.map((it, i) => (
              <div key={i} className="rounded-2xl border border-zinc-700 overflow-hidden">
                <button className="w-full text-left px-4 py-3 bg-zinc-800/60 hover:bg-zinc-800/80" onClick={() => setOpenIdx(openIdx === i ? null : i)}>
                  <div className="font-medium">{it.header}</div>
                  {it.sub && (<div className="text-xs text-zinc-400 mt-0.5">{it.sub}</div>)}
                </button>
                {openIdx === i && (<div className="px-4 py-4 bg-zinc-900/70 border-t border-zinc-700">{it.content}</div>)}
              </div>
            ))}
          </div>
        );
      }
      function CodeBlock({ code, output }) {
        const codeRef = useRef(null);
        const [copyState, setCopyState] = useState("idle");
        const onCopy = async () => {
          const txt = codeRef.current?.innerText ?? "";
          let ok = false;
          try {
            if (window.isSecureContext && navigator.clipboard?.writeText) {
              await navigator.clipboard.writeText(txt);
              ok = true;
            }
          } catch (_) {}
          if (!ok) {
            try {
              const ta = document.createElement("textarea");
              ta.value = txt; ta.setAttribute("readonly", ""); ta.style.position = "fixed"; ta.style.top = "-1000px";
              document.body.appendChild(ta); ta.focus(); ta.select();
              ok = document.execCommand("copy");
              document.body.removeChild(ta);
            } catch (_) { ok = false; }
          }
          if (!ok && codeRef.current) {
            const sel = window.getSelection();
            if (sel) { sel.removeAllRanges(); const range = document.createRange(); range.selectNodeContents(codeRef.current); sel.addRange(range); }
          }
          setCopyState(ok ? "ok" : "fail");
          setTimeout(() => setCopyState("idle"), 2000);
        };
        return (
          <div className="grid md:grid-cols-2 gap-3">
            <div className="border border-zinc-700 rounded-xl overflow-hidden">
              <div className="flex items-center justify-between px-3 py-2 bg-zinc-800/60 border-b border-zinc-700">
                <span className="text-xs uppercase tracking-wider text-zinc-400">Python / NumPy</span>
                <button
                  className={`text-sm px-2 py-1 rounded-lg ${copyState==="ok"?"bg-emerald-700":copyState==="fail"?"bg-amber-700":"bg-zinc-700 hover:bg-zinc-600"}`}
                  title={copyState==="fail"?"此環境封鎖剪貼簿：已自動選取文字，請用 Ctrl/Cmd+C":""}
                  onClick={onCopy}
                >
                  {copyState==="ok"?"已複製":copyState==="fail"?"手動複製":"複製"}
                </button>
              </div>
              <pre className="p-3 text-sm overflow-auto" ref={codeRef}><code>{code}</code></pre>
              {copyState==="fail" && (
                <div className="px-3 pb-3 text-xs text-amber-400">無法直接寫入剪貼簿：系統已選取文字，請按 Ctrl/Cmd + C 複製。</div>
              )}
            </div>
            <div className="border border-zinc-700 rounded-xl overflow-hidden">
              <div className="px-3 py-2 bg-zinc-800/60 border-b border-zinc-700 text-xs uppercase tracking-wider text-zinc-400">預期輸出</div>
              <pre className="p-3 text-sm overflow-auto"><code>{output}</code></pre>
            </div>
          </div>
        );
      }
      function Breadcrumbs({ trail }) {
        return (
          <nav className="text-sm text-zinc-400">
            {trail.map((t, i) => (
              <span key={i}>
                <span className={"" + (i === trail.length - 1 ? " text-zinc-200" : " hover:text-zinc-200 cursor-pointer")}>{t.label}</span>
                {i < trail.length - 1 && <span className="mx-2">›</span>}
              </span>
            ))}
          </nav>
        );
      }

      // ====== 主體 ======
      function NumpyCheatsheetSite() {
        const [section, setSection] = useState("home");
        const [sub, setSub] = useState(null);
        const [itemSlug, setItemSlug] = useState(null);

        useEffect(() => {
          const syncFromHash = () => {
            const raw = window.location.hash.replace(/^#\/?/, "");
            if (!raw) return;
            const [path, query] = raw.split("?");
            const [s, p] = path.split("/");
            if (["home","uses","demos","funcs"].includes(s)) {
              setSection(s);
              setSub(p || null);
            }
            const qs = new URLSearchParams(query || "");
            const it = qs.get("item");
            setItemSlug(it || null);
          };
          syncFromHash();
          window.addEventListener("hashchange", syncFromHash);
          return () => window.removeEventListener("hashchange", syncFromHash);
        }, []);

        useEffect(() => {
          let newHash = section + (sub ? "/" + sub : "");
          if (section === 'funcs' && itemSlug) newHash += `?item=${itemSlug}`;
          if (window.location.hash !== "#" + newHash) window.location.hash = newHash;
        }, [section, sub, itemSlug]);

        const gotoFunctionDetail = (label) => {
          for (const c of FUNCTIONS) {
            for (const it of c.items) {
              const tokens = tokensFromName(it.name);
              if (tokens.includes(label) || it.name.startsWith(label) || it.name.includes(label)) {
                const slug = slugifyItemName(it.name);
                setSection('funcs'); setSub(c.id); setItemSlug(slug);
                requestAnimationFrame(() => setTimeout(() => {
                  const el = document.getElementById('func-item-' + slug);
                  if (el) {
                    el.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    el.classList.add('ring-2','ring-emerald-500');
                    setTimeout(() => el.classList.remove('ring-2','ring-emerald-500'), 1200);
                  }
                }, 30));
                return;
              }
            }
          }
          alert(`尚未收錄「${label}」的說明，或名稱與條目不完全相符。`);
        };

        const trail = useMemo(() => {
          const t = [{ label: "首頁" }];
          if (section === "uses") t.push({ label: "用途" });
          if (section === "demos") t.push({ label: "函式/專案演示實例" });
          if (section === "funcs") t.push({ label: "函式細節與範例" });
          if (sub) {
            const label = (section === "uses" && USE_CASES.find((u) => u.id === sub)?.title)
              || (section === "demos" && DEMOS.find((d) => d.id === sub)?.title)
              || (section === "funcs" && FUNCTIONS.find((c) => c.id === sub)?.title)
              || null;
            if (label) t.push({ label });
          }
          return t;
        }, [section, sub]);

        return (
          <div className="min-h-screen">
            <header className="sticky top-0 z-40 border-b border-zinc-800 backdrop-blur bg-zinc-950/80">
              <div className="max-w-7xl mx-auto px-4 py-3 flex items-center gap-3">
                <div className="flex items-center gap-2 font-semibold text-lg"><span className="inline-block size-2 rounded-full bg-emerald-400" />NumPy 懶人包</div>
                <div className="ml-auto flex items-center gap-2">
                  <button className={`px-3 py-2 rounded-xl hover:bg-zinc-800/60 transition ${section==="home"?"border border-zinc-700 bg-zinc-800/40":""}`} onClick={() => { setSection("home"); setSub(null); setItemSlug(null); }}>首頁</button>
                  <Dropdown label="用途" items={<div className="grid grid-cols-1 gap-1">{USE_CASES.map((u)=>(<button key={u.id} className="text-left px-3 py-2 rounded-lg hover:bg-zinc-800/70" onClick={() => { setSection("uses"); setSub(u.id); setItemSlug(null); }}>{u.title}</button>))}</div>} />
                  <Dropdown label="函式/專案演示實例" items={<div className="grid grid-cols-1 gap-1">{DEMOS.map((d)=>(<button key={d.id} className="text-left px-3 py-2 rounded-lg hover:bg-zinc-800/70" onClick={() => { setSection("demos"); setSub(d.id); setItemSlug(null); }}>{d.title}</button>))}</div>} />
                  <Dropdown label="函式細節與範例" items={<div className="grid grid-cols-1 gap-1 max-h-80 overflow-auto pr-1">{FUNCTIONS.map((c)=>(<button key={c.id} className="text-left px-3 py-2 rounded-lg hover:bg-zinc-800/70" onClick={() => { setSection("funcs"); setSub(c.id); }}>{c.title}</button>))}</div>} />
                </div>
              </div>
            </header>
            <main className="max-w-7xl mx-auto px-4 py-6">
              <div className="mb-4"><Breadcrumbs trail={trail} /></div>
              {section === "home" && <Home setSection={setSection} setSub={setSub} />}
              {section === "uses" && <Uses sub={sub} setSub={setSub} onGotoFunc={gotoFunctionDetail} />}
              {section === "demos" && <Demos sub={sub} setSub={setSub} />}
              {section === "funcs" && <Funcs sub={sub} setSub={setSub} itemSlug={itemSlug} />}
            </main>
            <footer className="border-t border-zinc-800 mt-8">
              <div className="max-w-7xl mx-auto px-4 py-6 text-sm text-zinc-400 flex flex-wrap items-center gap-2">
                <span>© {new Date().getFullYear()} NumPy 懶人包</span>
                <span className="mx-2">·</span>
                <span>佈署：GitHub Pages / Vercel</span>
              </div>
            </footer>
          </div>
        );
      }

      function Home({ setSection, setSub }) {
        return (
          <section className="space-y-8">
            <div className="grid md:grid-cols-2 gap-6 items-center">
              <div className="space-y-4">
                <h1 className="text-3xl font-semibold leading-tight">NumPy 函式庫懶人包</h1>
                <p className="text-zinc-300">以「首頁 → 用途 → 演示 → 函式細節」的結構整理你需要的 NumPy 知識。初學者可先看「用途」，進一步參考「演示」，最後查表「函式細節」。</p>
                <div className="flex flex-wrap gap-3">
                  <button className="px-4 py-2 rounded-xl bg-emerald-500/20 border border-emerald-500 hover:bg-emerald-500/30" onClick={() => setSection("uses")}>由用途開始</button>
                  <button className="px-4 py-2 rounded-xl bg-zinc-800 border border-zinc-700 hover:bg-zinc-700" onClick={() => setSection("demos")}>看演示</button>
                  <button className="px-4 py-2 rounded-xl bg-zinc-800 border border-zinc-700 hover:bg-zinc-700" onClick={() => setSection("funcs")}>查函式</button>
                </div>
              </div>
              <div className="rounded-2xl border border-zinc-800 bg-gradient-to-br from-zinc-900 to-zinc-950 p-6">
                <ol className="space-y-3 text-zinc-300">
                  <li>① <b>用途</b>：以任務導向導覽（影像、代數、I/O、模擬…）</li>
                  <li>② <b>演示</b>：可直接複製的「輸入 + 預期輸出」小專案</li>
                  <li>③ <b>函式細節</b>：依分類列出常用 API 與最小可行範例</li>
                </ol>
              </div>
            </div>
            <div className="rounded-2xl border border-zinc-800 p-4 bg-zinc-900/40">
              <div className="text-sm text-zinc-400 mb-1">為什麼用 NumPy？（工具箱比喻）</div>
              <p className="text-zinc-300 leading-relaxed">想像你是木匠，要蓋房子與做家具。你不會自己造電鑽、圓鋸或砂帶機，而是直接拿現成工具；每種工具解決特定問題，用到什麼就 <span className="font-mono">import</span> 什麼。<span className="font-medium">NumPy 就是數值計算的工具箱</span>：提供陣列與向量化運算、亂數、線性代數等能力，像更換鑽頭一樣呼叫 <span className="font-mono">np.xxx</span> 完成工作，讓你把時間花在「建造」而不是「造工具」。</p>
            </div>
            <div className="grid md:grid-cols-3 gap-4">
              {USE_CASES.slice(0,3).map((u) => (
                <div key={u.id} className="rounded-2xl border border-zinc-800 p-4 bg-zinc-900/40">
                  <div className="text-lg font-medium mb-2">{u.title}</div>
                  <p className="text-sm text-zinc-300 mb-3">{u.brief}</p>
                  <ul className="list-disc list-inside text-sm text-zinc-400 space-y-1">
                    {u.bullets.map((b, i) => <li key={i}>{b}</li>)}
                  </ul>
                  <button className="mt-3 text-sm px-3 py-1.5 rounded-lg border border-zinc-700 hover:bg-zinc-800" onClick={() => { setSection("uses"); setSub(u.id); }}>查看用途細頁</button>
                </div>
              ))}
            </div>
          </section>
        );
      }

      function Uses({ sub, setSub, onGotoFunc }) {
        const current = USE_CASES.find((u) => u.id === sub) || USE_CASES[0];
        return (
          <section className="grid lg:grid-cols-[260px,1fr] gap-6">
            <aside className="space-y-2">
              <div className="text-xs uppercase tracking-wider text-zinc-400 mb-2">用途列表</div>
              <div className="space-y-1">
                {USE_CASES.map((u) => (
                  <button key={u.id} onClick={() => setSub(u.id)} className={`w-full text-left px-3 py-2 rounded-xl border ${current.id===u.id?"border-emerald-600 bg-emerald-500/10":"border-zinc-700 hover:bg-zinc-800/60"}`}>{u.title}</button>
                ))}
              </div>
            </aside>
            <div className="space-y-6">
              <header className="space-y-2">
                <h2 className="text-2xl font-semibold">{current.title}</h2>
                <p className="text-zinc-300">{current.brief}</p>
              </header>
              <div className="grid md:grid-cols-2 gap-4">
                <div className="rounded-2xl border border-zinc-800 p-4 bg-zinc-900/40">
                  <div className="text-sm text-zinc-400 mb-2">要點</div>
                  <ul className="list-disc list-inside text-zinc-300 space-y-1">{current.bullets.map((b, i) => <li key={i}>{b}</li>)}</ul>
                </div>
                <div className="rounded-2xl border border-zinc-800 p-4 bg-zinc-900/40">
                  <div className="text-sm text-zinc-400 mb-2">關聯函式（點擊跳至說明）</div>
                  <div className="flex flex-wrap gap-2">
                    {current.functions.map((f, i) => (
                      <button
                        key={i}
                        onClick={() => onGotoFunc(f)}
                        title={`前往 ${f} 的說明`}
                        className="px-2 py-1 rounded-lg border border-emerald-700/50 bg-emerald-500/10 hover:bg-emerald-500/20 text-sm cursor-pointer"
                      >{f}</button>
                    ))}
                  </div>
                </div>
              </div>
              <div>
                <Accordion items={[
                  { header: "快速範例一：索引旋轉 90°", sub: "T + 列反轉", content: <CodeBlock code={DEMOS[0].code} output={DEMOS[0].output} /> },
                  { header: "快速範例二：廣播加總", sub: "row(1×C) + col(R×1)", content: <CodeBlock code={`import numpy as np\nrow = np.arange(3)[None,:]\ncol = (np.arange(3)*10)[:,None]\nprint(row+col)`} output={`[[ 0  1  2]\n [10 11 12]\n [20 21 22]`} /> },
                ]} />
              </div>
            </div>
          </section>
        );
      }

      function Demos({ sub, setSub }) {
        const current = DEMOS.find((d) => d.id === sub) || DEMOS[0];
        return (
          <section className="grid lg:grid-cols-[280px,1fr] gap-6">
            <aside>
              <div className="text-xs uppercase tracking-wider text-zinc-400 mb-2">演示清單</div>
              <div className="space-y-1">
                {DEMOS.map((d) => (
                  <button key={d.id} onClick={() => setSub(d.id)} className={`w-full text-left px-3 py-2 rounded-xl border ${current.id===d.id?"border-emerald-600 bg-emerald-500/10":"border-zinc-700 hover:bg-zinc-800/60"}`}>{d.title}</button>
                ))}
              </div>
            </aside>
            <div className="space-y-5">
              <header className="space-y-1">
                <div className="text-sm text-zinc-400">目標</div>
                <h2 className="text-2xl font-semibold">{current.title}</h2>
                <p className="text-zinc-300">{current.goal}</p>
              </header>
              <CodeBlock code={current.code} output={current.output} />
              {current.notes?.length ? (
                <div className="rounded-2xl border border-zinc-800 p-4 bg-zinc-900/40">
                  <div className="text-sm text-zinc-400 mb-2">補充說明</div>
                  <ul className="list-disc list-inside text-zinc-300 space-y-1">{current.notes.map((n, i) => <li key={i}>{n}</li>)}</ul>
                </div>
              ) : null}
            </div>
          </section>
        );
      }

      function Funcs({ sub, setSub, itemSlug }) {
        const current = FUNCTIONS.find((c) => c.id === sub) || FUNCTIONS[0];

        useEffect(() => {
          if (!itemSlug) return;
          const el = document.getElementById('func-item-' + itemSlug);
          if (el) {
            el.scrollIntoView({ behavior: 'smooth', block: 'start' });
            el.classList.add('ring-2','ring-emerald-500');
            setTimeout(() => el.classList.remove('ring-2','ring-emerald-500'), 1200);
          }
        }, [itemSlug, current.id]);

        return (
          <section className="grid lg:grid-cols-[300px,1fr] gap-6">
            <aside>
              <div className="text-xs uppercase tracking-wider text-zinc-400 mb-2">分類</div>
              <div className="space-y-1">
                {FUNCTIONS.map((c) => (
                  <button key={c.id} onClick={() => setSub(c.id)} className={`w-full text-left px-3 py-2 rounded-xl border ${current.id===c.id?"border-emerald-600 bg-emerald-500/10":"border-zinc-700 hover:bg-zinc-800/60"}`}>{c.title}</button>
                ))}
              </div>
            </aside>
            <div className="space-y-6">
              <header>
                <h2 className="text-2xl font-semibold mb-1">{current.title}</h2>
                <p className="text-zinc-300">最小可行範例（含輸入與預期輸出），可直接複製到 Python 執行。若有「作用 / 常見用途 / 注意」等細節，將一併呈現。</p>
              </header>
              <div className="space-y-6">
                {current.items.map((it, i) => {
                  const slug = slugifyItemName(it.name);
                  return (
                    <div id={`func-item-${slug}`} key={i} className="rounded-2xl border border-zinc-800 p-4 bg-zinc-900/40 space-y-3">
                      <div className="flex flex-wrap items-center gap-x-3 gap-y-1">
                        <div className="font-mono text-emerald-300 text-sm">{it.name}</div>
                        {it.desc && <span className="text-xs text-zinc-400">— {it.desc}</span>}
                      </div>
                      {it.what && (<div><div className="text-sm text-zinc-400 mb-1">作用</div><p className="text-zinc-300 leading-relaxed">{it.what}</p></div>)}
                      {(it.uses && it.uses.length>0) && (<div><div className="text-sm text-zinc-400 mb-1">常見用途</div><ul className="list-disc list-inside text-zinc-300 space-y-1">{it.uses.map((u, idx) => <li key={idx}>{u}</li>)}</ul></div>)}
                      {(it.notes && it.notes.length>0) && (<div><div className="text-sm text-zinc-400 mb-1">注意</div><ul className="list-disc list-inside text-zinc-300 space-y-1">{it.notes.map((n, idx) => <li key={idx}>{n}</li>)}</ul></div>)}
                      {it.code && <CodeBlock code={it.code} output={it.output ?? ''} />}
                      {it.demo && (<div className="rounded-xl border border-zinc-800 p-3 bg-zinc-950/40">{it.demo}</div>)}
                      {it.imgdesc && (<div className="text-xs text-zinc-400 border-t border-zinc-800 pt-2">圖片描述：{it.imgdesc}</div>)}
                    </div>
                  );
                })}
              </div>
            </div>
          </section>
        );
      }

      ReactDOM.createRoot(document.getElementById('root')).render(<NumpyCheatsheetSite />);
    </script>
  </body>
</html>
